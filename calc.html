<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√°lculos Financeiros - Plano Patrimonial Ana</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8fafc;
            color: #334155;
            line-height: 1.6;
        }
        
        .header {
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .section {
            background: white;
            margin: 20px 0;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid #3b82f6;
        }
        
        .formula-box {
            background: #f1f5f9;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            position: relative;
        }
        
        .formula-box::before {
            content: "üìê F√≥rmula";
            position: absolute;
            top: -12px;
            left: 15px;
            background: #3b82f6;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-family: 'Segoe UI', sans-serif;
        }
        
        .code-box {
            background: #1e293b;
            color: #f1f5f9;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .highlight {
            background: #fef3c7;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .param-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .param-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 15px;
            border-radius: 8px;
        }
        
        .param-card strong {
            color: #1e3a8a;
        }
        
        .example {
            background: #ecfdf5;
            border-left: 4px solid #10b981;
            padding: 15px;
            margin: 15px 0;
        }
        
        .example::before {
            content: "üí° Exemplo Pr√°tico";
            font-weight: bold;
            color: #065f46;
            display: block;
            margin-bottom: 10px;
        }
        
        .result-box {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }
        
        .warning {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .warning::before {
            content: "‚ö†Ô∏è ";
            font-weight: bold;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            border: 1px solid #e2e8f0;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background: #f1f5f9;
            font-weight: bold;
            color: #1e3a8a;
        }
        
        .nav {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .nav a {
            color: #3b82f6;
            text-decoration: none;
            margin: 0 15px;
            padding: 8px 16px;
            border-radius: 6px;
            transition: background 0.3s;
        }
        
        .nav a:hover {
            background: #f1f5f9;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üè¢ C√°lculos Financeiros - Plano Patrimonial Ana</h1>
        <p>An√°lise Matem√°tica Completa | CIMO Family Office</p>
        <p><strong>Cliente:</strong> Ana, 53 anos | <strong>Patrim√¥nio:</strong> R$ 65 milh√µes</p>
    </div>

    <div class="nav">
        <a href="#parametros">Par√¢metros</a>
        <a href="#formulas">F√≥rmulas</a>
        <a href="#compromissos">Compromissos</a>
        <a href="#simulacoes">Simula√ß√µes</a>
        <a href="#status">Status</a>
    </div>

    <section id="parametros" class="section">
        <h2>üìä Par√¢metros e Constantes Fundamentais</h2>
        
        <div class="param-grid">
            <div class="param-card">
                <strong>PATRIM√îNIO</strong><br>
                R$ 65.000.000<br>
                <small>Base de c√°lculo (l√≠quido)</small>
            </div>
            <div class="param-card">
                <strong>IDADE_ANA</strong><br>
                53 anos<br>
                <small>Idade atual</small>
            </div>
            <div class="param-card">
                <strong>DESPESAS_BASE</strong><br>
                R$ 150.000/m√™s<br>
                <small>Padr√£o de vida</small>
            </div>
            <div class="param-card">
                <strong>RENDA_FILHOS</strong><br>
                R$ 150.000/m√™s<br>
                <small>R$ 50k √ó 3 filhos</small>
            </div>
            <div class="param-card">
                <strong>DOA√á√ïES</strong><br>
                R$ 50.000/m√™s<br>
                <small>Por 15 anos exatos</small>
            </div>
            <div class="param-card">
                <strong>INFLA√á√ÉO</strong><br>
                3.5% a.a.<br>
                <small>J√° descontada da taxa</small>
            </div>
        </div>

        <h3>üéØ Perfis de Asset Allocation</h3>
        <table>
            <tr>
                <th>Perfil</th>
                <th>RF Brasil</th>
                <th>RF Internacional</th>
                <th>A√ß√µes BR</th>
                <th>A√ß√µes Int</th>
                <th>Im√≥veis</th>
                <th>Liquidez</th>
                <th>Retorno Esperado</th>
            </tr>
            <tr>
                <td><strong>Conservador</strong></td>
                <td>70%</td>
                <td>15%</td>
                <td>5%</td>
                <td>5%</td>
                <td>3%</td>
                <td>2%</td>
                <td class="highlight">3.5% a.a.</td>
            </tr>
            <tr>
                <td><strong>Moderado</strong></td>
                <td>50%</td>
                <td>20%</td>
                <td>15%</td>
                <td>10%</td>
                <td>3%</td>
                <td>2%</td>
                <td class="highlight">4.5% a.a.</td>
            </tr>
            <tr>
                <td><strong>Balanceado</strong></td>
                <td>40%</td>
                <td>15%</td>
                <td>20%</td>
                <td>15%</td>
                <td>5%</td>
                <td>2%</td>
                <td class="highlight">5.2% a.a.</td>
            </tr>
        </table>
    </section>

    <section id="formulas" class="section">
        <h2>üßÆ F√≥rmulas Matem√°ticas Centrais</h2>
        
        <h3>1. Valor Presente de Anuidade (F√≥rmula Principal)</h3>
        <div class="formula-box">
            VP = PMT √ó [(1 - (1 + i)^(-n)) / i]
            <br><br>
            Onde:<br>
            ‚Ä¢ VP = Valor Presente<br>
            ‚Ä¢ PMT = Pagamento mensal<br>
            ‚Ä¢ i = Taxa mensal = (1 + taxa_anual)^(1/12) - 1<br>
            ‚Ä¢ n = N√∫mero de per√≠odos (meses)
        </div>

        <div class="code-box">
def valor_presente(fluxo_mensal, anos, taxa_anual):
    taxa_mensal = (1 + taxa_anual/100) ** (1/12) - 1
    periodos = anos * 12
    
    if taxa_mensal > 0:
        vp = fluxo_mensal * (1 - (1 + taxa_mensal) ** (-periodos)) / taxa_mensal
    else:
        vp = fluxo_mensal * periodos
    
    return vp
        </div>

        <div class="example">
            <strong>Exemplo:</strong> Despesas de Ana por 37 anos (90 - 53)<br>
            ‚Ä¢ PMT = R$ 150.000/m√™s<br>
            ‚Ä¢ Taxa = 4.5% a.a. ‚Üí Taxa mensal = (1.045)^(1/12) - 1 = 0.3663%<br>
            ‚Ä¢ Per√≠odos = 37 √ó 12 = 444 meses<br>
            ‚Ä¢ <strong>VP ‚âà R$ 35,8 milh√µes</strong>
        </div>

        <h3>2. Valor Futuro com Infla√ß√£o (Fazenda)</h3>
        <div class="formula-box">
            Valor_Futuro = Valor_Atual √ó (1 + infla√ß√£o)^anos
            <br><br>
            Onde: infla√ß√£o = 3.5% a.a.
        </div>

        <div class="example">
            <strong>Exemplo:</strong> Fazenda de R$ 2 milh√µes em 15 anos<br>
            ‚Ä¢ Valor_Futuro = 2.000.000 √ó (1.035)^15<br>
            ‚Ä¢ <strong>Valor_Futuro ‚âà R$ 3,4 milh√µes</strong>
        </div>
    </section>

    <section id="compromissos" class="section">
        <h2>üí∞ C√°lculos dos Compromissos</h2>
        
        <h3>Sequ√™ncia de C√°lculos:</h3>
        
        <div class="formula-box">
            1. VP_despesas = valor_presente(150.000, 37, 4.5)
            2. VP_filhos = valor_presente(150.000, 55, 4.5) √ó fator_desconto
            3. VP_doacoes = valor_presente(50.000, 15, 4.5)
            4. Total_Compromissos = VP_despesas + VP_filhos + VP_doacoes
            5. Fazenda_Dispon√≠vel = 65.000.000 - Total_Compromissos
        </div>

        <h3>üîÑ Timing da Renda dos Filhos</h3>
        <table>
            <tr>
                <th>Op√ß√£o</th>
                <th>In√≠cio</th>
                <th>Dura√ß√£o</th>
                <th>Fator Desconto</th>
                <th>VP Estimado</th>
            </tr>
            <tr>
                <td>Imediato</td>
                <td>Hoje</td>
                <td>55 anos</td>
                <td>1.0</td>
                <td>R$ 35,2M</td>
            </tr>
            <tr>
                <td>Aos 65 anos</td>
                <td>Em 12 anos</td>
                <td>43 anos</td>
                <td>0.629</td>
                <td>R$ 18,7M</td>
            </tr>
            <tr>
                <td>Falecimento</td>
                <td>Em 37 anos</td>
                <td>18 anos</td>
                <td>0.213</td>
                <td>R$ 3,8M</td>
            </tr>
        </table>

        <h3>üè° Sistema de Fases de Liquidez para Fazenda</h3>
        <div class="param-grid">
            <div class="param-card">
                <strong>Fase 1 (40% do per√≠odo)</strong><br>
                Liquidez: 2%<br>
                <small>Estrat√©gia normal</small>
            </div>
            <div class="param-card">
                <strong>Fase 2 (40% do per√≠odo)</strong><br>
                Liquidez: 4%<br>
                <small>Ac√∫mulo moderado</small>
            </div>
            <div class="param-card">
                <strong>Fase 3 (20% do per√≠odo)</strong><br>
                Liquidez: 15%<br>
                <small>Ac√∫mulo intensivo</small>
            </div>
        </div>
    </section>

    <section id="simulacoes" class="section">
        <h2>üé≤ Simula√ß√µes e Proje√ß√µes</h2>
        
        <h3>1. Proje√ß√£o Anual de Fluxo de Caixa</h3>
        <div class="code-box">
for ano in range(anos):
    idade_ana = 53 + ano + 1
    
    # RENDIMENTOS
    rendimentos = patrimonio_atual * (taxa / 100)
    
    # SA√çDAS
    saidas_anuais = 0
    if idade_ana <= expectativa:
        saidas_anuais += despesas * 12      # Despesas Ana
    if ano < 15:
        saidas_anuais += 50000 * 12         # Doa√ß√µes
    if idade_ana >= idade_inicio_filhos:
        saidas_anuais += 150000 * 12        # Renda filhos
    
    # SALDO L√çQUIDO
    saldo_liquido = rendimentos - saidas_anuais
    patrimonio_atual = max(patrimonio_atual + saldo_liquido, 0)
        </div>

        <h3>2. An√°lise de Sensibilidade</h3>
        <div class="formula-box">
            Para cada taxa ‚àà [2.0%, 2.5%, 3.0%, ..., 8.0%]:
            factor = 1 + (delta_taxa √ó 0.15)
            fazenda_estimada = fazenda_base √ó factor
        </div>

        <table>
            <tr>
                <th>Taxa Real</th>
                <th>Valor Fazenda</th>
                <th>% Patrim√¥nio</th>
                <th>Status</th>
            </tr>
            <tr>
                <td>2.0%</td>
                <td>-R$ 8,5M</td>
                <td>-13.1%</td>
                <td class="highlight" style="background: #fecaca;">Cr√≠tico</td>
            </tr>
            <tr>
                <td>3.5%</td>
                <td>R$ 2,1M</td>
                <td>3.2%</td>
                <td class="highlight" style="background: #fed7aa;">Aten√ß√£o</td>
            </tr>
            <tr>
                <td>4.5%</td>
                <td>R$ 8,3M</td>
                <td>12.8%</td>
                <td class="highlight" style="background: #fef3c7;">Aten√ß√£o</td>
            </tr>
            <tr>
                <td>6.0%</td>
                <td>R$ 18,7M</td>
                <td>28.8%</td>
                <td class="highlight" style="background: #dcfce7;">Vi√°vel</td>
            </tr>
        </table>

        <h3>3. Simula√ß√£o Monte Carlo</h3>
        <div class="code-box">
for simulacao in range(500):
    patrimonio = 65_000_000
    
    for ano in range(20):
        # Taxa aleat√≥ria entre 2.5% e 7.0%
        base_return = random.uniform(2.5, 7.0) / 100
        
        # Adicionar volatilidade (¬±15%)
        volatility = (random.random() - 0.5) * 0.30
        year_return = base_return + volatility
        
        # Aplicar retorno e sa√≠das
        patrimonio = patrimonio * (1 + year_return) - 1_800_000
        patrimonio = max(patrimonio, 0)
    
    final_values.append(patrimonio)
        </div>

        <div class="result-box">
            <h4>Resultados Monte Carlo (500 simula√ß√µes)</h4>
            <strong>P10:</strong> -R$ 2,1M | <strong>P50:</strong> R$ 5,8M | <strong>P90:</strong> R$ 15,2M<br>
            <strong>Taxa de Sucesso:</strong> 72%
        </div>
    </section>

    <section id="status" class="section">
        <h2>üìà Determina√ß√£o de Status e Viabilidade</h2>
        
        <h3>Algoritmo de Classifica√ß√£o</h3>
        <div class="code-box">
def determinar_status(fazenda, percentual):
    if fazenda < 0:
        return 'cr√≠tico'
    elif percentual < 5:
        return 'cr√≠tico'  
    elif percentual < 15:
        return 'aten√ß√£o'
    else:
        return 'vi√°vel'
        </div>

        <h3>üìä Crit√©rios de Status</h3>
        <div class="param-grid">
            <div class="param-card" style="border-left: 4px solid #dc2626;">
                <strong style="color: #dc2626;">üî¥ CR√çTICO</strong><br>
                ‚Ä¢ Fazenda negativa<br>
                ‚Ä¢ OU < 5% do patrim√¥nio<br>
                <small>A√ß√£o urgente necess√°ria</small>
            </div>
            <div class="param-card" style="border-left: 4px solid #f59e0b;">
                <strong style="color: #f59e0b;">üü° ATEN√á√ÉO</strong><br>
                ‚Ä¢ Entre 5% e 15%<br>
                ‚Ä¢ do patrim√¥nio<br>
                <small>Monitoramento frequente</small>
            </div>
            <div class="param-card" style="border-left: 4px solid #10b981;">
                <strong style="color: #10b981;">üü¢ VI√ÅVEL</strong><br>
                ‚Ä¢ ‚â• 15% do patrim√¥nio<br>
                ‚Ä¢ Margem confort√°vel<br>
                <small>Plano sustent√°vel</small>
            </div>
        </div>

        <h3>üéØ Exemplo de C√°lculo Completo</h3>
        <div class="example">
            <strong>Cen√°rio:</strong> Taxa 4.5%, Expectativa 90 anos, Renda filhos ap√≥s falecimento<br><br>
            
            <strong>1. VP Despesas Ana:</strong><br>
            valor_presente(150.000, 37, 4.5) = <span class="highlight">R$ 35.791.234</span><br><br>
            
            <strong>2. VP Renda Filhos:</strong><br>
            valor_presente(150.000, 18, 4.5) √ó (1.045)^(-37) = <span class="highlight">R$ 3.847.592</span><br><br>
            
            <strong>3. VP Doa√ß√µes:</strong><br>
            valor_presente(50.000, 15, 4.5) = <span class="highlight">R$ 6.127.843</span><br><br>
            
            <strong>4. Total Compromissos:</strong><br>
            35.791.234 + 3.847.592 + 6.127.843 = <span class="highlight">R$ 45.766.669</span><br><br>
            
            <strong>5. Valor Fazenda:</strong><br>
            65.000.000 - 45.766.669 = <span class="highlight">R$ 19.233.331</span><br><br>
            
            <strong>6. Percentual:</strong><br>
            (19.233.331 / 65.000.000) √ó 100 = <span class="highlight">29.6%</span><br><br>
            
            <strong>7. Status:</strong> <span class="highlight" style="background: #dcfce7; color: #065f46;">VI√ÅVEL</span>
        </div>

        <div class="warning">
            <strong>Observa√ß√£o Importante:</strong> Todos os valores s√£o em termos reais (poder de compra de 2025). 
            A taxa de retorno informada j√° desconta a infla√ß√£o estimada de 3.5% a.a.
        </div>
    </section>

    <div class="result-box" style="margin-top: 30px;">
        <h3>üéØ Resposta √† Pergunta Central</h3>
        <p><strong>"Quanto Ana pode gastar com a fazenda?"</strong></p>
        <p>Com os par√¢metros moderados (4.5% a.a., expectativa 90 anos), Ana pode destinar aproximadamente 
        <strong>R$ 19,2 milh√µes (29.6% do patrim√¥nio)</strong> para a fazenda, mantendo todos os outros compromissos.</p>
    </div>

    <footer style="text-align: center; margin-top: 40px; padding: 20px; color: #64748b;">
        <p>üìä C√°lculos baseados em metodologia de planejamento patrimonial quantitativo</p>
        <p><strong>J√∫lio Lage</strong> | An√°lise Matem√°tica Completa</p>
    </footer>
</body>
</html>